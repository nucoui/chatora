# runtime api の刷新

## 意義
今の設計だと、コンポーネントをうまく処理できていない。処理はできているが冗長なものになっている。
この問題を解決することでよりシンプルなコードでコンポーネントを扱えるようになる。

## 最終動作目標
- [ ] 全てのコンポーネントを custom elements (shadow dom) として扱う

## 具体的なアクションプラン
まず、リアクティビティシステムの根幹は変えない。
vNodeによる仮想DOMでのリレンダリングを行う。そしてvNodeはmount関数で初期生成し、patch関数で更新する。patch関数の動作条件は @chatora/reactivity の watch。
signalや、computedによる変数定義も引き続き行う。

大きく変えるのは、vNode,mount,patch,型定義。システムの根幹と仕組みは変えない。が、処理は変更する。
JSXは引き続きサポートしますが、コンポーネントの使い方は変えても問題ありません。
SSR時でも動作するように、Declarative Shadow DOM での実現を目指す。
CSR時点で、customElements.defineで定義されたコンポーネントを、shadow domとしてマウントする。
この時にリアクティビティシステムを利用して、signalやcomputedの変更を監視し、変更があった場合にpatch関数を呼び出す。
最終動作目標を達成させるためには何をしてもいいです。

## 絶対に守るべき項目
- 破壊的な変更は許可します
- 後方互換性は考慮しません
- テストは必ず実施します
- JSXは引き続きサポートしますが、コンポーネントの使い方は変えても問題ありません。
- signal(), computed()による変数定義も引き続きサポートします
- defineProps, defineEmitsも引き続きサポートします

